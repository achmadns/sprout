[[ package gen;

import se.rupy.http.*;
import se.rupy.sprout.*;

import com.maxmind.geoip.*;

public class register extends Sprout {
	public int index() { return 2; }
	public String path() { return "/register"; }
	public void filter(Event event) throws Event, Exception {
		Output out = event.output();
		String country = event.string("country");
		
		if(country.length() == 0) {
			country = User.lookup.getCountry(event.remote()).getCode();
		}
		
		if(country.equals("--")) {
			country = "";
		}
		
		event.daemon().chain("/header").filter(event); ]]

  <table border="0" width="100">
    <form name="register" action="register" method="post">

[[		if(event.string("error").length() > 0) { ]]

      <tr>
        <td colspan="2">
          <font color="red"><i>[[ event.string("error") ]]</i></font>
        </td>
      </tr>

[[		} ]]

      <tr>
        <td>[[ i18n("eMail") ]]&nbsp;<font color="red">*</font>&nbsp;&nbsp;</td>
        <td>
          <input type="text" class="large" name="mail" value="[[ event.string("mail") ]]" tabindex="1"/>
        </td>
      </tr>
      <tr>
        <td>[[ i18n("Nickname") ]]&nbsp;<font color="red">*</font>&nbsp;&nbsp;</td>
        <td>
          <input type="text" class="small" name="name" value="[[ event.string("name") ]]" tabindex="2"/>
        </td>
      </tr>
      <tr>
        <td>[[ i18n("Password") ]]&nbsp;<font color="red">*</font>&nbsp;&nbsp;</td>
        <td>
          <input type="password" class="small" name="pass" value="[[ event.string("pass") ]]" tabindex="3"/>
        </td>
      </tr>
      <tr>
        <td>[[ i18n("Confirm") ]]&nbsp;<font color="red">*</font>&nbsp;&nbsp;</td>
        <td>
          <input type="password" class="small" name="word" value="[[ event.string("word") ]]" onkeypress="return myKeyPressed(event)" tabindex="4"/>
        </td>
      </tr>
      <tr>
        <td>[[ i18n("Birthday") ]]&nbsp;<font color="red">*</font>&nbsp;&nbsp;</td>
        <td>
          <select name="day" class="tiny" tabindex="5">
            <option value="0">[[ i18n("Day") ]]</option>
            
[[		for(int i = 1; i < 32; i++) { ]]

            <option value="[[ i ]]"[[ event.medium("day") == i ? " selected" : "" ]]>[[ i ]]</option>

[[		} ]]

          </select>
          <select name="month" class="small" tabindex="6">
            <option value="0">[[ i18n("Month") ]]</option>
            
[[		for(int i = 1; i < 13; i++) { ]]

            <option value="[[ i ]]"[[ event.medium("month") == i ? " selected" : "" ]]>[[ User.month[i - 1] ]]</option>

[[		} ]]

          </select>
          <select name="year" class="medium" tabindex="7">
            <option value="0">[[ i18n("Year") ]]</option>
            
[[		for(int i = 1900; i < 2009; i++) { ]]

            <option value="[[ i ]]"[[ event.query().medium("year", 1990) == i ? " selected" : "" ]]>[[ i ]]</option>

[[		} ]]

          </select>
        </td>
        <td>
          <input type="checkbox" name="show_birthday"[[ event.string("show_birthday").equals("on") ? " checked" : "" ]]/>
        </td>
      </tr>
      <tr>
        <td>[[ i18n("Country") ]]&nbsp;<img id="flag" src="res/flag/[[ country.toLowerCase() ]].png"[[ out.print(country.length() == 0 ? " style=\"display: none;\"" : ""); ]]/></td>
        <td>
          <select name="country" class="large" onChange="changeFlag(this);" tabindex="8">
            <option value="--">N/A</option>
            
[[		for(int i = 0; i < User.countryCode.length; i++) { ]]

            <option value="[[ User.countryCode[i] ]]"[[ country.equals(User.countryCode[i]) ? " selected" : "" ]]>[[ User.countryName[i] ]]</option>

[[		} ]]

          </select>
        </td>
        <td>
          <input type="checkbox" name="show_country"[[ event.string("show_country").equals("on") ? " checked" : "" ]]/>
        </td>
      </tr>
      <tr>
        <td>[[ out.print(i18n("First&nbsp;Name")); ]]&nbsp;&nbsp;</td>
        <td>
          <input type="first" class="small" name="first" value="[[ event.string("first") ]]" tabindex="9"/>
        </td>
        <td>
          <input type="checkbox" name="show_first_name"[[ event.string("show_first_name").equals("on") ? " checked" : "" ]]/>
        </td>
      </tr>
      <tr>
        <td>[[ out.print(i18n("Last&nbsp;Name")); ]]&nbsp;&nbsp;</td>
        <td>
          <input type="last" class="small" name="last" value="[[ event.string("last") ]]" tabindex="10"/>
        </td>
        <td>
          <input type="checkbox" name="show_last_name"[[ event.string("show_last_name").equals("on") ? " checked" : "" ]]/>
        </td>
      </tr>
      <tr>
        <td>[[ i18n("Gender") ]]&nbsp;&nbsp;</td>
        <td>
          <input type="radio" name="gender" value="female" tabindex="11"[[ event.string("gender").equals("female") ? " checked" : "" ]]/>[[ i18n("Female") ]]
          <input type="radio" name="gender" value="male" tabindex="12"[[ event.string("gender").equals("male") ? " checked" : "" ]]/>[[ i18n("Male") ]]
        </td>
        <td>
          <input type="checkbox" name="show_gender"[[ event.string("show_gender").equals("on") ? " checked" : "" ]]/>
        </td>
      </tr>
      <tr>
        <td colspan="2">
          <a href="" class="arrow" onclick="document.register.submit(); return false;">
            <span>[[ i18n("Register") ]]</span>
          </a>
        </td>
      </tr>
    </form>
  </table>
</div>
</body>
</html>

[[ } 
} ]]

